library(ggplot2)
library(leaps)
library(broom)
library(RobStatTM)
library(reshape2)
#DATOS
Vessel_X = read.table('Vessel_X.txt', header =F,sep = ',')
Vessel_Y = read.table('Vessel_Y.txt', header =F,sep = ',')
frecuencias = seq(100,dim(Vessel_X)[2]+99)
ds_sampler_vasija = data.frame( t(rbind(frecuencias,
Vessel_X[1,],
Vessel_X[10,],
Vessel_X[60,],
Vessel_X[100,],
Vessel_X[180,])) )
colnames(ds_sampler_vasija)<-c("frecuencias","vasija_1","vasija_10","vasija_60","vasija_100","vasija_180")
ggplot(ds_sampler_vasija)+
geom_line(aes(x = frecuencias, y = log(vasija_1) )) +
geom_line(aes(x = frecuencias, y = log(vasija_10)), colour= 'red') +
geom_line(aes(x = frecuencias, y = log(vasija_60)), colour= 'orange') +
geom_line(aes(x = frecuencias, y = log(vasija_100)), colour= 'green') +
geom_line(aes(x = frecuencias, y = log(vasija_180)), colour= 'yellow') +
labs(x = "Frecuencias",
y = 'Log(Intensidad)')
# Medias y Variancias
x_bar_X = matrix(colMeans(Vessel_X))
x_var_X =  matrix(diag(var(Vessel_X)))
se = sqrt(x_var_X)
dsa = data.frame(cbind(x_bar_X,x_var_X,se))
colnames(dsa) = c('means','var','se')
ggplot(dsa, aes(x=seq(100, dim(dsa)[1]+99), y=log(means))) +
geom_errorbar(aes(ymin=log(means-se), ymax= log(means+se)), width=.1,colour="red") +
labs(x="Frecuencias") +
geom_line() +
geom_point(colour= 'black' )
#Revisamos este compuesto contra todos los demás del set Vassey_y
ds_my = melt(Vessel_Y, id.vars = c("V6"), variable.name = "Compuestos") #cambio de estructura para hacer el gráfico.
ggplot(ds_my, aes(V6,value)) + geom_line(aes(colour = Compuestos))
# Conectamos la info de SO3 con los datos de frecuencias, y luego separamos los sets
SO3 = Vessel_Y[,6]
dsb = data.frame(cbind(SO3,Vessel_X))
set.seed(123)
n = nrow(dsb)
n_test = 40 #aprox un 20%
n_train =  n - n_test
test_indexes = sample(n, n_test)
dsb_test = dsb[test_indexes, ]
dsb_train = dsb[-test_indexes, ]
write.table(dsb_test,
paste( 'data_test_p1.csv', sep=''),
sep=",",
row.names=F,
col.names=T)
write.table(dsb_train,
paste('data_train_p1.csv', sep=''),
sep=",",
row.names=F,
col.names=T)
dsb_data_train = read.csv(file.choose(),
sep=",",
header=T)
dsb_data_test = read.csv(file.choose(),
sep=",",
header=T)
vesselx <- Vessel_X
vessely <- Vessel_Y
#Grafique en función de la frecuencia las medias y varianzas de X, y también algunos espectros (o sea, x(i,j) en función de j para algunos i)"
#SD versus frecuencia
plot(apply(vesselx,2,sd),ty="l",ylab="SD",xlab="Frecuencia")
#Media versus frecuencia
plot(apply(vesselx,2,mean),ty="l",ylab="Media",xlab="Frecuencia") #Media versus frecuencia
#RSD versus frecuencia
plot((apply(vesselx,2,sd)/apply(vesselx,2,mean)),ty="l",ylab="RSD",xlab="Frecuencia") #RSD versus frecuencia
#Grafico algunos espectros para chusmear
plot(as.vector(t(vesselx[1,])),ty="l",col=1,ylim=c(0,7000),xlab="Frecuencia",ylab="Intensidad",lwd=1.2)
lines(as.vector(t(vesselx[10,])),ty="l",col=2,lwd=1.2)
lines(as.vector(t(vesselx[60,])),ty="l",col=3,lwd=1.2)
lines(as.vector(t(vesselx[100,])),ty="l",col=4,lwd=1.2)
lines(as.vector(t(vesselx[180,])),ty="l",col=5,lwd=1.2)
legend("topleft",legend=c(1,10,60,100,180),col=c(1,2,3,4,5),lty=1)
#Pruebo con una regresión de componentes principales sobre los datos tal cual
#Fijo la semilla y sampleo 140 para entrenar y las otras 40 para testear
set.seed(100)
sample<-sample(x=nrow(vesselx),140,replace=FALSE)
so3<-vessely[,6]
so3train<-so3[sample]
so3test<-so3[-sample]
vesselxtrain<-vesselx[sample,]
vesselxtest<-vesselx[-sample,]
#Cargo la library de PCR
library(pls)
#Hago un ajuste por PCR
ajustepcr<-pcr(so3train ~ as.matrix(vesselxtrain),scale=TRUE)
plot(ajustepcr)
#Estimo el ECM de predicción usando el grupo de testeo en función del numero de componentes principales
error<-seq(1,139)
for(i in (1:139)){
error[i] = mean( (so3test-predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=i))^2 )
}
plot(error,ty="l",xlab="Nùmero de componentes principales",ylab="Error cuadrático medio de predicción")
summary(ajustepcr)
ajustepcr$scale
ajustepcr$terms
ajustepcr$model
ajustepcr$call
ajustepcr$scale
ajustepcr$scale[1]
ajustepcr$scale
library(FactoMineR)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=25)
plot(pred25comp,so3test)
plot(pred25comp,so3test,asp=1)
plot(pred25comp,so3test,asp=1, xlim=c(0,0.4), ylim = c(0,0.4))
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4))
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=25)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=25)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4))
points(pred25compTrain,so3train, xlim=c(0,0.4), ylim = c(0,0.4))
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4))
points(pred25compTrain,so3train, col = 4)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=20)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=20)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=20)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=100)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=22)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=22)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=25)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=25)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 6)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=100)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=100)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25comp = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
pred25compTrain = predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=120)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred25compTrain,so3train, col = 4)
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25comp,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
#points(pred120compTest,so3test, col = 4)
?points
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4, type="X")
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4, type="x")
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2)
points(pred120compTest,so3test, col = 4, pch="x")
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 100 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=25)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 100 comp")
points(pred120compTest,so3test, col = 4, pch="x")
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=10)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=10)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=5)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=10)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=120)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=10)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=130)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=10)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=1)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=2)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=20)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=50)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
pred25compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=25)
pred120compTest = predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=139)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 y 120 comp")
points(pred120compTest,so3test, col = 4, pch="x")
lines(so3test,so3test)
plot(pred25compTest,so3test, xlim=c(0,0.4), ylim = c(0,0.4), col = 2, xlab="pred con 25 -o- y 120 comp -x- ")
points(pred120compTest,so3test, col = 4, pch="x")
lines(so3test,so3test)
?pls
jack.test(ajustepcr)
jack.test(ajustepcr, ncomp=139)
plot(
ajustepcr,
plottype = c("prediction", "validation", "coefficients", "scores", "loadings",
"biplot", "correlation")
)
plot.mvr(
ajustepcr,
plottype = c("prediction", "validation", "coefficients", "scores", "loadings",
"biplot", "correlation")
)
library(pls)
?pls
ajustepcr<-mvr(so3train ~ as.matrix(vesselxtrain),scale=TRUE)
plot(ajustepcr)
plot.mvr(ajustepcr)
ajustemvr<-mvr(so3train ~ as.matrix(vesselxtrain),scale=TRUE)
plot(
ajustemvr,
plottype = c("prediction", "validation", "coefficients", "scores", "loadings",
"biplot", "correlation")
)
predplot(
ajustemvr,
plottype = c("prediction", "validation", "coefficients", "scores", "loadings",
"biplot", "correlation")
)
predplot.mvr(
ajustemvr,
plottype = c("prediction", "validation", "coefficients", "scores", "loadings",
"biplot", "correlation")
)
#Veo el gráfico de residuos versus ajustados para CP=(100) (menor ECM)
plot(residuals(ajustepcr)[,,100]~predict(ajustepcr,newdata=as.matrix(vesselxtrain),ncomp=100),xlab="Y predicho",ylab="Residuo",ylim=c(-0.06,0.06))
abline(h=0,col="red")
#Veo el gráfico de residuos versus ajustados para CP=(100) (menor ECM)
plot(residuals(ajustepcr)[,,100]~predict(ajustepcr,newdata=as.matrix(vesselxtest),ncomp=100),xlab="Y predicho",ylab="Residuo",ylim=c(-0.06,0.06))
install.packages("fda")
library(fda)
library(fda)
install.packages("fda")
Rscript -e "install.packages('RCurl')"
install.packages("RCurl")
install.packages("MVN")
install.packages("gsl”)
install.packages("gsl")
sudo apt-get install libgsl-dev
setwd("~/Documents/MEL/MAESTRIA/TP_Especializacion/TP_ESP")
rm(list = ls())
graphics.off()
library(ggplot2)
library(ggpubr)
library(leaps)
library(broom)
library(RobStatTM)
library(reshape2)
library(stringr)
fou<-read.table("mfeat-fou",header=FALSE)
fac<-read.table("mfeat-fac",header=FALSE)
kar<-read.table("mfeat-kar",header=FALSE)
pix<-read.table("mfeat-pix",header=FALSE)
zer<-read.table("mfeat-zer",header=FALSE)
mor<-read.table("mfeat-mor",header=FALSE)
mor$V1<-as.factor(mor$V1)
mor$V2<-as.factor(mor$V2)
mor$V3<-as.factor(mor$V3)
mfeat<-cbind(fou,fac,kar,pix,zer)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,643,1))#as.vector(seq(1,649,1))
class<-rep(0,2000)
class[(1:200)]<-0
class[(201:400)]<-1
class[(401:600)]<-2
class[(601:800)]<-3
class[(801:1000)]<-4
class[(1001:1200)]<-5
class[(1201:1400)]<-6
class[(1401:1600)]<-7
class[(1601:1800)]<-8
class[(1801:2000)]<-9
class<-as.factor(class)
datos<-cbind(mfeat,class)
fou<-read.table("mfeat-fou",header=FALSE)
fac<-read.table("mfeat-fac",header=FALSE)
kar<-read.table("mfeat-kar",header=FALSE)
pix<-read.table("mfeat-pix",header=FALSE)
zer<-read.table("mfeat-zer",header=FALSE)
mor<-read.table("mfeat-mor",header=FALSE)
mor$V1<-as.factor(mor$V1)
mor$V2<-as.factor(mor$V2)
mor$V3<-as.factor(mor$V3)
mfeat<-cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,649,1))#as.vector(seq(1,649,1))
class<-rep(0,2000)
class[(1:200)]<-0
class[(201:400)]<-1
class[(401:600)]<-2
class[(601:800)]<-3
class[(801:1000)]<-4
class[(1001:1200)]<-5
class[(1201:1400)]<-6
class[(1401:1600)]<-7
class[(1601:1800)]<-8
class[(1801:2000)]<-9
class<-as.factor(class)
datos<-cbind(mfeat,class)
set.seed(100)
n = nrow(datos)
trainIndex = sample(1:n, size = round(0.7*n), replace=FALSE)
ds.train = datos[trainIndex ,]
ds.test = datos[-trainIndex ,]
library(glmnet)
set.seed(110)
XX<-model.matrix(lm(class~.,data=ds.train))
Xtest<-model.matrix(lm(class~.,data=ds.test))
cv.lasso<-cv.glmnet(x=XX,y=ds.train$class,family="multinomial",alpha=1,nfolds=3,trace.it=1)
ajustelasso<-glmnet(x=XX,y=ds.train$class,family="multinomial",alpha=1,lambda=cv.lasso$lambda.1se, trace.it=1)
mean(predict(ajustelasso,newx=Xtest,type="class")==ds.test$class)
library(caret)
car::vif(ajustelasso)
car::vif(lm(class~.,data=ds.train))
cor(XX)
cor(ds.train)
cor(subset(ds.train, select=c(-class))
cor(subset(ds.train, select=c(-class)))
fou<-read.table("mfeat-fou",header=FALSE)
fac<-read.table("mfeat-fac",header=FALSE)
kar<-read.table("mfeat-kar",header=FALSE)
pix<-read.table("mfeat-pix",header=FALSE)
zer<-read.table("mfeat-zer",header=FALSE)
mor<-read.table("mfeat-mor",header=FALSE)
#mor$V1<-as.factor(mor$V1)
#mor$V2<-as.factor(mor$V2)
#mor$V3<-as.factor(mor$V3)
mfeat<-cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,649,1))#as.vector(seq(1,649,1))
class<-rep(0,2000)
class[(1:200)]<-0
class[(201:400)]<-1
class[(401:600)]<-2
class[(601:800)]<-3
class[(801:1000)]<-4
class[(1001:1200)]<-5
class[(1201:1400)]<-6
class[(1401:1600)]<-7
class[(1601:1800)]<-8
class[(1801:2000)]<-9
class<-as.factor(class)
datos<-cbind(mfeat,class)
set.seed(100)
n = nrow(datos)
trainIndex = sample(1:n, size = round(0.7*n), replace=FALSE)
ds.train = datos[trainIndex ,]
ds.test = datos[-trainIndex ,]
cor(subset(ds.train, select=c(-class)))
car::vif(lm(class~.,data=ds.train))
cor(subset(ds.train, select=c(-class))) > 0.5
heatmap(cor(subset(ds.train, select=c(-class))))
heatmap(cor(subset(ds.train, select=c(-class))),  Rowv = NA, Colv = NA)
car::vif(lm(class~.,data=ds.train))
sum(cor(subset(ds.train, select=c(-class))) > 0.5)
sum(cor(subset(ds.train, select=c(-class))) > 0.9)
sum(0.5 < cor(subset(ds.train, select=c(-class))) < 0.9 )
sum(cor(subset(ds.train, select=c(-class))) < 0.9 & >0.5)
sum(cor(subset(ds.train, select=c(-class))) < 0.9 & > 0.5)
mean(cor(subset(ds.train, select=c(-class))) >0.5)
table(cor(subset(ds.train, select=c(-class))) >0.5)
cor(subset(ds.train, select=c(-class))) >0.5
type(cor(subset(ds.train, select=c(-class))) >0.5)
class(cor(subset(ds.train, select=c(-class))) >0.5)
heatmap(mor,  Rowv = NA, Colv = NA)
heatmap(pix,  Rowv = NA, Colv = NA)
heatmap(cor(pix),  Rowv = NA, Colv = NA)
modelo_lda <- lda(formula = ds.train$class ~ .,data = pix)
library(MASS)
modelo_lda <- lda(formula = ds.train$class ~ .,data = pix)
modelo_lda <- lda(formula = datos$class ~ .,data = pix)
modelo_lda
predicciones <- predict(object = modelo_lda, newdata = pix)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
library(MVN)
outliers <- mvn(data = pix, mvnTest = "hz", multivariateOutlierMethod = "quan")
outliers <- mvn(data = pix, mvnTest = "hz", multivariateOutlierMethod = "quan")
outliers <- mvn(data = fou, mvnTest = "hz", multivariateOutlierMethod = "quan")
View(pix)
View(pix)
View(pix)
View(mor)
View(pix)
View(pix)
View(pix)
View(pix)
pix
royston_test$multivariateNormality
royston_test <- mvn(data = fou, mvnTest = "royston", multivariatePlot = "qq")
royston_test$multivariateNormality
royston_test <- mvn(data = pix, mvnTest = "royston", multivariatePlot = "qq")
royston_test$multivariateNormality
fou
cbin(pix,fou)
cbind(pix,fou)
modelo_lda <- lda(formula = datos$class ~ .,data = cbind(pix,fou))
length(pix)
length(mfeat)
mfeat<-cbind(fou,pix)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
modelo_lda
predicciones <- predict(object = modelo_lda, newdata = pix)
predicciones <- predict(object = modelo_lda, newdata = mfeat)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
zer
mfeat<-cbind(fou,pix,zer)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
predicciones <- predict(object = modelo_lda, newdata = mfeat)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
kar
mfeat<-cbind(fou,pix,zer,kar)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
predicciones <- predict(object = modelo_lda, newdata = mfeat)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
fac
mfeat<-cbind(fou,pix,zer,kar,fac)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
mfeat<-cbind(fou,pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
modelo_lda
predicciones <- predict(object = modelo_lda, newdata = mfeat)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
royston_test <- mvn(data = mfeat, mvnTest = "royston", multivariatePlot = "qq")
# devtools::install_github("arsilva87/biotools")
library(biotools)
boxM(data = mfeat, grouping = ds.train$class)
dim(mfeat)
dim(ds.train)
boxM(data = mfeat, grouping =dato$class)
boxM(data = mfeat, grouping =datos$class)
mfeat<-cbind(fac,pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
mfeat<-cbind(fac)#,pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
heatmap(cor(fac),  Rowv = NA, Colv = NA)
car::vif(lm(datos$class~.,data=fac))
car::vif(lm(datos$class~.,data=pix))
car::vif(lm(datos$class~.,data=fou))
car::vif(lm(fou[,1]~.,data=fou))
car::vif(lm(fac[,1]~.,data=fac))
fac[!:10]
fac[!:10]
fac[1:10]
car::vif(lm(fac[,1]~.,data=fac[1:10]))
car::vif(lm(fac[,1]~.,data=fac[1:100]))
car::vif(lm(fac[,1]~.,data=fac[1:80]))
car::vif(lm(fac[,1]~.,data=fac[1:50]))
car::vif(lm(fac[,2]~.,data=fac[1:50]))
car::vif(lm(fac[,3]~.,data=fac[1:50]))
car::vif(lm(fac[,3]~.,data=fac[1:60]))
car::vif(lm(fac[,3]~.,data=fac[1:55]))
mfeat<-cbind(fac[1:55]))#,pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
mfeat<-cbind(fac[1:55])#,pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
modelo_lda
predicciones <- predict(object = modelo_lda, newdata = mfeat)
table(datos$class, predicciones$class, dnn = c("Clase real", "Clase predicha"))
trainig_error <- mean(datos$class != predicciones$class) * 100
paste("trainig_error =", trainig_error, "%")
mfeat<-cbind(fac[1:55],pix,zer,kar,mor)#cbind(fou,fac,kar,pix,zer,mor)
colnames(mfeat)<-as.vector(seq(1,length(mfeat),1))
modelo_lda <- lda(formula = datos$class ~ .,data = mfeat)
